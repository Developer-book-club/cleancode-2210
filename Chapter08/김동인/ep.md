# 8장 경계

- 시스템에 들어가는 모든 소프트웨어를 직접 개발하는 경우는 드물다.
- 패키지, 오픈소스를 이용한다. 때로는 다른 팀이 제공하는 컴포넌트를 사용한다.
- 외부 코드를 깔끔하게 통합해야만 한다.
- 소프트웨어 경계를 깔끔하게 처리하는 기법과 기교를 살펴봐야 한다.

# 외부 코드 사용하기

- 인터페이스 제공자와 인터페이스 사용자 사이에는 특유의 긴장이 존재한다.
- 패키지 제공자나 프레임워크 제공자는 적용성을 최대한 넓히려 애쓴다.
    - 더 많은 환경에서 돌아가야 더 많은 고객이 구매한다.
- 반면 사용자는 자신의 요구에 집중하는 인터페이스를 바란다.
- 이러한 긴장으로 시스템 경계에서 문제가 생길 소지가 많다.

# 경계 살피고 익히기

- 외부코드를 사용하면 적은 시간에 더 많은 기능을 출시하기 쉬워진다.
- 만약 외부에서 가져온 패키지를 사용하고 싶다면 어디서 어떻게 시작해야 좋을까
    - 우리 자신을 위해 우리가 사용할 코드를 테스트해보자.
- 외부 코드를 익히기는 어렵다. 외부 코드를 통합하기도 어렵다. 두 가지를 동시에 하기는 두 배나 어렵다. 우리쪽 코드를 작성해 외부 코드를 호출하는 대신 간단한 테스트 케이스를 작성해 외부 코드를 익히면 어떨까?
    - 짐 뉴커크(Jim Newkirk)는 이를 학습 테스트라고 부른다.
- 학습 테스트는 프로그램에서 사용하려는 방식대로 외부 API를 부른다.

# 학습 테스트는 공짜 이상이다

- 학습 테스트는 이해도를 높여주는 정확한 실험이다.
- 투자하는 노력보다 얻는 성과가 더 크다.
- 패키지가 예상대로 도는지 검증한다. 통합한 이후라고 하더라도 패키지가 우리 코드와 호환되리라는 보장은 없다.
- 패키지 작성자는 버그를 수정하고 기능도 추가한다.
- 학습 테스트를 이용한 학습이 필요하든 그렇지 않든 실제 코드와 동일한 방식으로 인터페이스를 사용하는 테스트 케이스가 필요하다.
- 경계 테스트가 있다면 패키지의 새 버전으로 이전하기 쉬워진다. 낡은 버전을 필요 이상으로 오랫동안 사용하려는 유혹에 빠지기 쉽다.

# 아직 존재하지 않는 코드를 사용하기

- 경계와 관련해 또 다른 유형은 아는 코드와 모르는 코드를 분리하는 경계이다.
- 우리 지식이 경계를 너머 미치지 못하는 코드 영역이 있다.

![image](https://user-images.githubusercontent.com/66561524/198337156-19c400b5-c300-4aeb-8276-142a5d393bae.png)

- 우리가 ‘송신기’ 모듈에게 원하는 기능은 다음과 같다.
    - 지정한 주파수를 이용해 이 스트림에서 들어오는 자료를 아날로그 신호로 전송하라
- 우리가 바라는 인터페이스를 구현하면 우리는 인터페이스를 통제할 수 있다. 또한 코드 가독성도 높아지고 코드 의도도 분명해진다.
- 송신기 API를 정의한 후에는 `TransmitterAdapter`를 구현해 간극을 메웠다. ADAPTER 패턴으로 API 사용을 캡슐화해 API가 바뀔 때 수정할 코드를 한 곳으로 모은다.
- 경계 테스트 케이스를 새엇ㅇ해 우리가 API를 올바르게 사용하는지 테스트할 수도 있다.

# 깨끗한 경계

- 경계에서는 변경이 대표적인 예시이다.
- 소프트웨어 설계가 우수하다면 변경하는데 많은 투자와 재작업이 필요하지 않다.
- 엄청난 시간과 노력과 재작업을 요구하지 않는다. 통제하지 못하는 코드를 사용할 때는 많은 투자를 하거나 향후 변경 비용이 지나치게 커지지 않도록 각별히 주의해야 한다.
- 경계에 위치하는 코드는 깔끔히 분리한다. 기대치를 정의하는 테스트 케이스도 작성한다.
- 코드에서 외부 패키지를 세세하게 알아야 할 필요가 없다. 통제가 불가능한 외부 패키지에 의존하는 대신 통제가 가능한 우리 코드에 의존하는 편이 좋다.
- 외부 패키지를 호출하는 코드를 가능한 줄여 경계를 관리하자. Map에서 봤듯이 새로운 클래스도 경계를 감싸거나 아니면 ADAPTER 패턴을 사용해 우리가 원하는 인터페이스를 패키지가 제공하는 인터페이스로 변환하자.
- 어느 방법이든 코드 가독성이 높아지며 경계 인터페이스를 사용하는 일관성도 높아지며 외부 패키지가 변했을 때 변경할 코드도 줄어든다.
