# Overview

> 나쁜 코드에 주석을 달지 마라. 새로 짜라
> - 브라이언 W. 커니핸, P.J. 플라우거

- 잘 달린 주석은 그 어떤 정보보다 유용하다.
    - 경솔하고 근거 없는 주석은 코드를 이해하기 어렵게 만든다.
    - 오래되고 조잡한 주석은 거짓과 잘못된 정보를 퍼뜨려 해악을 미친다.
- 주석은 쉰들러 리스트가 아니다.
    - 2차 세계대전에서 발생한 나치의 홀로코스트가 있었을 때 쉰들러라는 사람이 유대인을 살리기 위해 작성한 리스트.
    - 순수하게 선하지 못하다.
    - 필요악이다.
- 프로그래밍 언어를 치밀하게 사용해서 의도를 표현할 능력이 있다면 주석은 필요하지 않다.
    - 코드로 의도를 표현하지 못하고 실패를 만회하기 위해서 주석을 사용한다.
    - 부정확한 주석은 없는 것보다도 나쁘다.
- 진실은 코드에서만 존재한다.

# 주석은 나쁜 코드를 보완하지 못한다

- 코드에 주석을 추가하는 일반적인 이유는 코드 품질이 나쁘기 때문이다.
- 표현력이 풍부하고 깔끔하며 주석이 거의 없는 코드가 복잡하고 어수선하며 주석이 많이 달린 코드보다 좋다.
- 자신이 저지른 난장판을 주석으로 설명하려 애쓰는 대신에 그 난장판을 깨끗이 치우는 데 시간을 보내라!

# 코드로 의도를 표현하라!

- 코드로 의도를 설명하기 어렵지만, 그것이 코드는 의도를 표현하기 위한 훌륭한 수단이 아닌 것은 아니다.

```java
// 직원에게 복지 혜택을 받을 자격이 있는지 검사한다.
if ((employee.flags & HOURLY_FLAG) && (employee.age > 65))
```

```java
if (employee.isEligibleForFullBenefits())
```

# 좋은 주석

- 유익하고 필요한 주석이 있다.

## 법적인 주석

- 회사가 정립한 구현 표준에 맞춰 법적인 이유로 특정 주석을 명시해야하는 경우
- 주석 헤더는 IDE에서 자동으로 축소할 수 있다.

```java
// Copyright (C) 2003,2004,2005 by Object Mentor, Inc. All rights reserved.
// GNU General Public License 버전 2 이상을 따르는 조건으로 배포한다.
```

- 모든 조항과 모든 조건을 열거하는 대신에 표준 라이선스나 외부 문서를 참조해도 된다.

## 정보를 제공하는 주석

```java
// 테스트 중인 Responder 인스턴스를 반환한다.
protected abstract Responder responderInstance();
```

- 기본적인 정보를 주석으로 제공하면 편리하다.
    - 가능하면 함수에 정보를 담아두자.

```java
// kk:mm:ss EEE, MMM dd, yyyy 형식이다.
Pattern timeMatcher = Pattern.compile(
"\\d*:\\d*:\\d* \\w*, \\w* \\d*, \\d*");
```

- 정규표현식이 시각과 날짜를 뜻한다고 설명한다.
    - 이왕이면 시각과 날짜를 변환하는 클래스를 만들자.

## 의도를 설명하는 주석

- 주석은 구현을 이해하게 도와주는 선을 넘어 결정에 깔린 의도까지 설명한다.
    - 주석으로 흥미로운 결정을 기록한 예제다.
    - 개발자는 두 객체를 비교할 때 다른 어떤 객체보다 자기 객체에 높은 순위를 주기로 결정했다.

```java
public int compareTo(Object o) {
	if (o instanceof wikiPagePath) {
		wikiPagePath p = (WikiPagePath) o;
		String compressedName = StringUtil.join(names, "");
		String compressedArgumentName = StringUtil.join(names, "");
		String compressedName.compareTo(compressedArgumentName);
	}
	return 1; // 오른쪽 유형이므로 정렬 순위가 더 높다.
}
```

- 저자의 의도가 분명히 드러난다.

## 의미를 명료하게 밝히는 주석

- 모호한 인수나 반환값은 그 의미를 읽기 좋게 표현하면 이해하기 쉬워진다.
- 하지만 주석은 올바른지 검증하기 쉽지 않다.
    - 주석이 위엄한 이유

## 결과를 경호나는 주석

- 다른 개발자에게 결과를 경고할 목적으로 주석을 사용한다.
- 요즘에는 `@Ignore` 속성을 이용해 테스트 케이스를 꺼버린다.

## TODO 주석

- ‘앞으로 할 일’을 //TODO 주석으로 남기면 편하다.
- TODO 주석은 프로그래머가 필요하지만 당장 구현하기 어려운 업무를 기술한다.
    - 필요 없는 기능을 삭제하라는 알림
    - 누군가에게 문제를 봐달라는 요청
    - 더 좋은 이름을 떠올려달라는 부탁
    - 앞으로 발생할 이벤트에 맞춰 코드를 고치라는 주의
    - 다만, 나쁜 코드를 남겨놓는 핑계가 되서는 안된다.
- 요즘 나오는 IDE는 TODO 주석을 전부 찾아 보여주는 기능을 제공하므로 주석을 잊어버릴 염려는 없다.

## 중요성을 강조하는 주석

- 대수롭지 않다고 여결질 뭔가의 중요성을 강조하기 위해서 주석을 사용한다.

```java
String listItemContent = match.group(3).trim();
// 여기서 trim은 정말 중요하다. trim 함수는 문자열에서 시작 공백을 제거한다.
// 문자열에 시작 공백이 있으면 다른 문자열로 인식되기 때문이다.
new ListItemWidget(this, listItemContent, this.level + 1);
return buildList(text.substring(match.end()));
```

## 공개 API에서 Javadocs

- 설명이 잘 된 공개 API는 참으로 유용하고 만족스럽다.
- 공개 API를 구현한다면 훌륭한 Javadocs를 작성한다.

# 나쁜 주석

- 대다수 주석이 이 범주에 속한다.
- 허술한 코드를 지탱하거나 엉성한 코드를 변명하거나 미숙한 결정을 합리화하는 개발자의 독백에 가깝다.

## 주절거리는 주석

- 특별한 이유 없이 의무감으로 혹은 프로세스에서 하라고 하니깐 마지못해 주석을 단다면 시간낭비다.
- 이해가 안되어 다른 모듈까지 뒤져야 하는 주석은 독자와 제대로 소통하지 못하는 주석이다.

## 같은 이야기를 중복하는 주석

- 코드보다 많은 정보를 제공하지 못하는 주석은 필요가 없다.
- 코드를 정당화하는 주석도 아니고 의도나 근거를 설명하는 주석이 되지 못한다.
- 코드보다 부정확하면 독자가 함수를 대충 이해하고 넘어가게 만든다.

## 오해할 여지가 있는 주석

- 개발자가 딱 맞을 정도로 엄밀하게는 주석을 달지 못하기도 한다.
- (코드보다 읽기도 어려운) 주석에 담긴 ‘살짝 잘못된 정보’로 인해 어느 개발자가 경솔하게 함수를 호출할지도 모른다.

## 의무적으로 다는 주석

- 모든 함수에 Javadocs를 달거나 모든 변수에 주석을 달 필요는 없다.
- 코드만 헷갈리게 만들고 거짓말할 가능성을 높이며 잘못된 정보를 제공할 여지만 만든다.

## 이력을 기록하는 주석

- 사람들은 모듈을 편집할 때마다 첫 머리에 주석을 추가한다.
- 옛날에는 이렇게 변경 이력을 기록하고 관리하는 관례가 바람직했지만 이제는 혼란만 가중할 뿐이다.

## 있으나 마나 한 주석

- 당연한 주석을 작성하는 경우가 있다. 이는 코드와 중복된 내용일 뿐이다.
- 이 주석은 개발자가 주석을 무시하는 습관을 만든다.

## 무서운 잡음

- 때로는 Javadocs도 잡음이다.
- 주석을 작성한 저자가 주의를 기울이지 않았다면 독자는 얻을 이익이 없다.

## 함수나 변수로 표현할 수 있다면 주석을 달지 마라

```java
// 전역 목록 <smodule>에 속하는 모듈이 우리가 속한 하위 시스템에 의존하는가?
if (smodule.getDependSubsystems().contains(subSysMod.getSubSystem()))

```

```java
ArrayList moduleDependees = smoodule.getDependSubsystems();
String ourSubSystem = subSysMod.getSubSystem();
if (moduleDependees.contains(ourSubSystem))
```

- 코드를 작성한 저자는 주석을 먼저 달고 주석에 맞춰 코드를 작성했을지도 모른다.
- 하지만 주석이 필요하지 않도록 코드를 개선하는 편이 좋다.

## 닫는 괄호에 다는 주석

- 중첩이 심하고 장황한 함수에는 의미가 있을지 모르지만 작고 캡슐화된 함수에는 잡음이다.
- 닫는 괄호에 주석을 달기보다는 함수를 줄이려고 시도하자

```java
while (( /*..*//)) {
	/* .. */
} // end while

```

## 공로를 돌리거나 저자를 표시하는 주석

- 소스 코드 관리 시스템은 누가 언제 무엇을 추가했는지 귀신처럼 기억한다.
- 저자 이름으로 코드를 오염시킬 필요가 없다.
- 소스 코드 관리 시스템에 저장하자

## 주석으로 처리한 코드

- 주석으로 처리된 코드는 다른 사람들이 지우기를 주저한다.
- 이유가 있을 거라고 생각한다.
- 코드 관리 시스템이 있으니 주석으로 처리하지 말고 코드를 삭제하자. 잃어버릴 염려가 없다.

## HTML 주석

- HTML 주석은 읽기가 어렵다.
- Javadocs 같은 것을 작성할 때 HTML 태그를 삽입하는 의미는 개발자가 아닌 도구를 사용하는 것이 좋다.

## 전역 정보

- 코드 일부에 주석을 달면서 시스템의 전반적인 정보를 기술하지마라
    - 포트 정보, 시스템 정보
- 함수가 포트 값을 통제하지 못한다. 즉, 시스템 정보가 변해도 주석은 변하지 않는 것을 명심하자.

## 너무 많은 정보

- 흥미로운 역사나 관련 없는 정보를 장황하게 늘어놓지 마라
- 독자에게 불필요한 정보일 뿐이다.

## 모호한 관계

- 주석과 주석이 설명하는 코드는 둘 사이 관계가 명백해야 한다.
- 주석을 다는 목적은 코드만으로 부족해서인데 주석 자체가 다시 설명을 요구해서는 안된다.

## 함수 헤더

- 짧은 함수는 긴 설명이 필요 없다.
- 짧고 한 가지만 수행하며 이름을 잘 붙인 함수가 주석으로 헤더를 추가한 함수보다 훨씬 좋다.

## 비공개 코드에서 Javadocs

- 공개 API Javadocs가 유용하지만 공개하지 않을 코드라면 Javadocs는 쓸모가 없다.
- 시스템 내부에 속한 클래스와 함수에 Javadocs를 생성할 필요가 없다.
- 유용하지 않고 Javadocs 주석이 요구하는 형식으로 인해 코드만 보기 싫고 산만해진다.
